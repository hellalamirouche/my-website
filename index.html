
<html><head><base href="https://visio.ai/"><title>Visio - Real-Time User Connections with Camera Access</title>
<style>
  body {
    font-family: 'Roboto', sans-serif;
    line-height: 1.6;
    margin: 0;
    padding: 0;
    background-color: #f4f7f9;
    color: #333;
  }
  header {
    background-color: #2c3e50;
    color: white;
    text-align: center;
    padding: 1rem 0;
  }
  main {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }
  .user-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem;
  }
  .user-card {
    background-color: white;
    border-radius: 8px;
    padding: 1rem;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    transition: transform 0.3s ease;
    cursor: pointer;
  }
  .user-card:hover {
    transform: translateY(-5px);
  }
  .user-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    margin: 0 auto 1rem;
    display: block;
    object-fit: cover;
  }
  .user-name {
    text-align: center;
    font-weight: bold;
    margin-bottom: 0.5rem;
  }
  .user-status {
    text-align: center;
    font-size: 0.9rem;
    color: #27ae60;
  }
  .connection-info {
    text-align: center;
    margin-bottom: 2rem;
    font-size: 1.2rem;
  }
  #connectionCount {
    font-weight: bold;
    color: #3498db;
  }
  #joinForm {
    text-align: center;
    margin-bottom: 2rem;
  }
  #joinForm input, #joinForm button {
    padding: 0.5rem;
    font-size: 1rem;
  }
  #joinForm button {
    background-color: #3498db;
    color: white;
    border: none;
    cursor: pointer;
  }
  #cameraModal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.4);
  }
  .modal-content {
    background-color: #fefefe;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 600px;
  }
  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
  }
  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }
  #userVideo {
    width: 100%;
    max-width: 640px;
    height: auto;
  }
</style>
</head>
<body>
<header>
  <h1>Visio - Real-Time User Connections with Camera Access</h1>
</header>
<main>
  <div class="connection-info">
    Currently connected users: <span id="connectionCount">0</span>
  </div>
  <div id="joinForm">
    <input type="text" id="nameInput" placeholder="Enter your name">
    <button onclick="joinSession()">Join Session</button>
  </div>
  <div id="userGrid" class="user-grid">
    <!-- User cards will be dynamically inserted here -->
  </div>
</main>

<div id="cameraModal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2 id="modalUserName"></h2>
    <video id="userVideo" autoplay playsinline></video>
  </div>
</div>

<script>
  const users = [];
  const userGrid = document.getElementById('userGrid');
  const connectionCount = document.getElementById('connectionCount');
  const nameInput = document.getElementById('nameInput');
  const modal = document.getElementById('cameraModal');
  const modalUserName = document.getElementById('modalUserName');
  const userVideo = document.getElementById('userVideo');
  const closeBtn = document.getElementsByClassName('close')[0];
  
  let localStream;

  function createUserCard(user) {
    const card = document.createElement('div');
    card.className = 'user-card';
    card.innerHTML = `
      <img src="${user.avatar}" alt="${user.name}" class="user-avatar">
      <div class="user-name">${user.name}</div>
      <div class="user-status">Online</div>
    `;
    card.onclick = () => showUserCamera(user);
    return card;
  }

  function updateUserGrid() {
    userGrid.innerHTML = '';
    users.forEach(user => {
      userGrid.appendChild(createUserCard(user));
    });
    connectionCount.textContent = users.length;
  }

  async function addUser(name) {
    const avatar = `https://api.dicebear.com/6.x/avataaars/svg?seed=${name}`;
    const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: false });
    users.push({ name, avatar, stream });
    updateUserGrid();
  }

  function removeUser(name) {
    const index = users.findIndex(user => user.name === name);
    if (index !== -1) {
      const user = users[index];
      if (user.stream) {
        user.stream.getTracks().forEach(track => track.stop());
      }
      users.splice(index, 1);
      updateUserGrid();
    }
  }

  async function joinSession() {
    const name = nameInput.value.trim();
    if (name) {
      try {
        await addUser(name);
        nameInput.value = '';
        alert(`Welcome, ${name}! You've joined the session. Your camera is now active.`);
      } catch (error) {
        alert("Failed to access camera. Please make sure you have given permission to use the camera.");
        console.error(error);
      }
    } else {
      alert("Please enter a valid name.");
    }
  }

  function showUserCamera(user) {
    modalUserName.textContent = `${user.name}'s Camera`;
    userVideo.srcObject = user.stream;
    modal.style.display = "block";
  }

  closeBtn.onclick = function() {
    modal.style.display = "none";
    userVideo.srcObject = null;
  }

  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = "none";
      userVideo.srcObject = null;
    }
  }

  // Simulating other users joining (for demonstration purposes)
  function simulateOtherUsers() {
    const names = ['John', 'Emma', 'Michael', 'Sophia', 'William'];
    names.forEach(async (name) => {
      if (!users.some(user => user.name === name)) {
        await addUser(name);
      }
    });
  }

  // Call this function to simulate other users
  simulateOtherUsers();
</script>
</body></html>
